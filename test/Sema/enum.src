// V %srcc --sema --verify %s
program test;

enum x {
    a,
    b,
    c,
}

x y = a;
var y = a; // expected-error: Unknown symbol 'a'

x y = x::d; // expected-error: Unknown symbol 'd'
x y = d; // expected-error: Unknown symbol 'd'

#assert x::a as int == 0;
#assert x::b as int == 1;
#assert x::c as int == 2;
#assert x::c as int == 3; // expected-error: Assertion failed: 'x::c as int == 3'

enum x2 {
    a,
    b,
    c,
}

x y = x::a;
x2 y = x2::a;
x2 y = x::a; // expected-error: Cannot convert expression of type 'x' to 'x2'
x y = x2::a; // expected-error: Cannot convert expression of type 'x2' to 'x'

enum E {
    a = 42,
    b,
    c = 63,
    d = c,
    e,
}

#assert E::a as int == 42;
#assert E::b as int == 43;
#assert E::c as int == 63;
#assert E::d as int == 63;
#assert E::e as int == 64;

enum E2 { // expected-error: Definition of type 'E2' depends on itself
    a = b,
    b,
}

#assert E3::a as int == 42;
#assert E3::b as int == 43;
#assert E3::c as int == 44;

enum E3 {
    a = 42,
    b,
    c,
}

#assert E3::a as int == 42;
#assert E3::b as int == 43;
#assert E3::c as int == 44;

int[E4::a as int] xx;

enum E4 { // expected-error: Definition of type 'E4' depends on itself
    a = b,
    b,
}

int[E4::a as int] yy;

enum E5 { a = E6::a as int } // expected-error: Definition of type 'E5' depends on itself
enum E6 { a = E5::a as int }

enum E7 : i8 {
    a = 100,
}

#assert E7.elem == i8;

enum E8 : void {} // expected-error: Underyling type of enum must be an integer type, was 'void'
enum E9 : type {} // expected-error: Underyling type of enum must be an integer type, was 'type'
enum E10 : bool {}

#assert E10.elem == bool;

enum E11 : i8 {
    a = 255,
    b, // expected-error: Value '256' of enumerator does not fit in underlying type 'i8'
    c,
    d,
    e = 255,
    f, // expected-error: Value '256' of enumerator does not fit in underlying type 'i8'
}

enum E12 : i16 {
    a = 65535,
    b, // expected-error: Value '65536' of enumerator does not fit in underlying type 'i16'
    c,
    d,
}
