// V %srcc --sema --verify %s
program test;

struct s {
    int x;
}

proc q = s(42);

eval {
    s a = (1);
    with a { x = 4; }
    assert a.x == 4;
}

eval with s(2) {
    assert x == 2;
    x = 3;
    assert x == 3;
}

eval with q() do assert x == 42;
eval with q() do assert x == 44; // expected-error: Assertion failed: 'x == 44'

// TODO: Implement proper support for member access on type variables so we can actually evaluate this
with i64 {
    assert bits == 64;
    assert bytes == 8;
    assert name == "i64";
}