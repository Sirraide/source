// R      %srcc --ir   --target x86_64-unknown-linux -I test/inputs %s
// R[//L] %srcc --llvm --target x86_64-unknown-linux -I test/inputs %s
program test;

import <macros.h> as macros;

proc a = macros::NESTED;
proc b = macros::FOOBAR;
proc c = macros::SIX;
proc d = macros::NOT_CONSTEXPR;

// * @__srcc_expanded_macro_0 = external 8, align 8
// +
// + proc __src_main external ccc {
// + entry:
// +     ret
// + }
// +
// + proc _S1aFI32E private ccc -> i32 {
// + entry:
// +     ret i32 42
// + }
// +
// + proc _S1bFI32E private ccc -> i32 {
// + entry:
// +     ret i32 84
// + }
// +
// + proc _S1cFI32E private ccc -> i32 {
// + entry:
// +     ret i32 6
// + }
// +
// + proc _S1dFRvE private ccc -> ptr {
// + entry:
// +     %0 = load ptr, @__srcc_expanded_macro_0, align 8
// +     ret ptr %0
// + }

//L * ; ModuleID = 'test'
//L + source_filename = "test"
//L + target datalayout = "e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-i128:128-f80:128-n8:16:32:64-S128"
//L + target triple = "x86_64-unknown-linux"
//L +
//L + @__srcc_expanded_macro_0 = dso_local global ptr inttoptr (i64 -1 to ptr), align 8
//L +
//L + ; Function Attrs: nounwind
//L + define void @__src_main() #0 {
//L +   ret void
//L + }
//L +
//L + ; Function Attrs: nounwind
//L + define private i32 @_S1aFI32E() #0 {
//L +   ret i32 42
//L + }
//L +
//L + ; Function Attrs: nounwind
//L + define private i32 @_S1bFI32E() #0 {
//L +   ret i32 84
//L + }
//L +
//L + ; Function Attrs: nounwind
//L + define private i32 @_S1cFI32E() #0 {
//L +   ret i32 6
//L + }
//L +
//L + ; Function Attrs: nounwind
//L + define private ptr @_S1dFRvE() #0 {
//L +   %1 = load ptr, ptr @__srcc_expanded_macro_0, align 8
//L +   ret ptr %1
//L + }
//L +
//L + attributes #0 = { nounwind }
//L +
//L + !llvm.module.flags = !{!0, !1, !2, !3}
//L + !llvm.ident = !{!4}
//L +
//L + !0 = !{i32 2, !"Debug Info Version", i32 3}
//L + !1 = !{i32 1, !"wchar_size", i32 4}
//L + !2 = !{i32 8, !"PIC Level", i32 0}
//L + !3 = !{i32 7, !"PIE Level", i32 2}
//L + !4 = !{!"clang version 22.0.0git"}
