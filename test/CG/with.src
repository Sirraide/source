// R %srcc --ir --target x86_64-unknown-linux %s
program test;

struct s {
    int x;
}

proc q() = s(42);
proc sink(int) extern;

s a = (1);
with a { x = 4; }
sink(a.x);

with s(2) {
    sink(x);
    x = 3;
    sink(x);
}

with q() {
    sink(x);
}

// * @_S1a.1 = private 8, align 8
// +
// + proc __src_main norecurse external ccc {
// +     #0 = 8, align 8
// +     #1 = 8, align 8
// +
// + entry:
// +     store @_S1a.1, i64 1, align 8
// +     store @_S1a.1, i64 4, align 8
// +     %0 = load i64, @_S1a.1, align 8
// +     call ccc void sink(i64 %0)
// +     store #0, i64 2, align 8
// +     %1 = load i64, #0, align 8
// +     call ccc void sink(i64 %1)
// +     store #0, i64 3, align 8
// +     %2 = load i64, #0, align 8
// +     call ccc void sink(i64 %2)
// +     %3 = call ccc i64 _S1qFT1sE.1()
// +     store #1, i64 %3, align 8
// +     %4 = load i64, #1, align 8
// +     call ccc void sink(i64 %4)
// +     ret
// + }
// +
// + proc sink (i64) external ccc;
// +
// + proc _S1qFT1sE.1 private ccc -> i64 {
// +     #0 = 8, align 8
// +
// + entry:
// +     store #0, i64 42, align 8
// +     %0 = load i64, #0, align 8
// +     ret i64 %0
// + }
